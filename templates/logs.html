{% extends "base.html" %}

{% block title %}Logs - RankZen Control Panel{% endblock %}
{% block header %}Activity Logs{% endblock %}

{% block content %}
<div class="card">
  <h3>üìù Activity Logs</h3>
  <p>Monitor bot activity, errors, and system events.</p>

  <div style="margin-bottom: 1rem;">
    <a href="{{ url_for('logs', category='all') }}" class="btn" style="{% if current_category == 'all' %}background: var(--brand);{% endif %}">All</a>
    <a href="{{ url_for('logs', category='bot') }}" class="btn" style="{% if current_category == 'bot' %}background: var(--brand);{% endif %}">Bot</a>
    <a href="{{ url_for('logs', category='audit') }}" class="btn" style="{% if current_category == 'audit' %}background: var(--brand);{% endif %}">Audit</a>
    <a href="{{ url_for('logs', category='outreach') }}" class="btn" style="{% if current_category == 'outreach' %}background: var(--brand);{% endif %}">Outreach</a>
    <a href="{{ url_for('logs', category='admin') }}" class="btn" style="{% if current_category == 'admin' %}background: var(--brand);{% endif %}">Admin</a>
    <a href="{{ url_for('logs', category='system') }}" class="btn" style="{% if current_category == 'system' %}background: var(--brand);{% endif %}">System</a>
  </div>

  <div style="max-height: 600px; overflow-y: auto; border: 1px solid var(--panel); border-radius: var(--radius);">
    {% for log in logs %}
    <div class="log-{{ log.level.lower() }}" style="padding: 0.75rem; border-bottom: 1px solid var(--panel);">
      <div style="display: flex; align-items: center; gap: 1rem;">
        <small style="color: var(--muted); font-family: monospace;">
          {{ log.timestamp.strftime('%m-%d %H:%M:%S') }}
        </small>
        <span style="background: var(--panel); padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem; font-weight: 600;">
          {{ log.level }}
        </span>
        <small style="color: var(--brand);">[{{ log.category }}]</small>
      </div>
      <div style="margin-top: 0.5rem;">
        {{ log.message }}
      </div>
    </div>
    {% endfor %}
  </div>

  {% if pagination %}
  <div class="pagination">
    {% if pagination.has_prev %}
      <a href="{{ url_for('logs', page=pagination.prev_num, category=current_category) }}">&laquo; Previous</a>
    {% endif %}

    {% for page_num in pagination.iter_pages() %}
      {% if page_num %}
        {% if page_num == pagination.page %}
          <span class="active">{{ page_num }}</span>
        {% else %}
          <a href="{{ url_for('logs', page=page_num, category=current_category) }}">{{ page_num }}</a>
        {% endif %}
      {% else %}
        <span>...</span>
      {% endif %}
    {% endfor %}

    {% if pagination.has_next %}
      <a href="{{ url_for('logs', page=pagination.next_num, category=current_category) }}">Next &raquo;</a>
    {% endif %}
  </div>
  {% endif %}
</div>

{% if not logs %}
<div class="card">
  <p style="text-align: center; color: var(--muted);">
    No logs found for the selected category.
  </p>
</div>
{% endif %}
{% endblock %}
